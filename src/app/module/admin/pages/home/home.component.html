<section class="p-6">
  <div class="flex items-center justify-between mb-6">
    <p class="text-xl font-semibold text-gray-800">Purchase Order Management</p>
    <button
      type="button"
      class="text-white bg-blue-600 hover:bg-blue-700 focus:ring-4 focus:outline-none focus:ring-blue-300 font-medium rounded-lg text-sm px-4 py-2 inline-flex items-center gap-2 transition-colors"
      (click)="openAddPo()"
    >
      <svg
        xmlns="http://www.w3.org/2000/svg"
        fill="none"
        viewBox="0 0 24 24"
        stroke="currentColor"
        class="w-4 h-4"
      >
        <rect x="3" y="5" width="18" height="14" rx="2" stroke-width="1.5" />
        <path stroke-width="1.5" d="M7 9h10M7 13h6" />
      </svg>
      New PO
    </button>
  </div>

  <mat-tab-group
    [(selectedIndex)]="activeTabIndex"
    (selectedTabChange)="onTabChange($event.index)"
  >
    <mat-tab label="INCOMING">
      <div
        class="overflow-x-auto shadow-sm rounded-lg border border-gray-200 mt-4 bg-white"
      >
        <div *ngIf="!isLoading">
          <table
            mat-table
            class="w-full text-sm text-left text-gray-500"
            [dataSource]="sortedData"
            (matSortChange)="sortData($event)"
            matSort
            #empTbSort="matSort"
          >
            <ng-container matColumnDef="poNumber">
              <th
                mat-header-cell
                *matHeaderCellDef
                mat-sort-header="poNumber"
                class="px-4 py-3 text-xs font-medium text-gray-500 uppercase tracking-wider bg-gray-50"
              >
                #PO
              </th>
              <td
                mat-cell
                *matCellDef="let element"
                class="px-4 py-3 font-medium text-gray-900 whitespace-nowrap"
              >
                {{ element.poNumber }}
              </td>
            </ng-container>

            <ng-container matColumnDef="customerName">
              <th
                mat-header-cell
                *matHeaderCellDef
                mat-sort-header="customerName"
                class="px-4 py-3 text-xs font-medium text-gray-500 uppercase tracking-wider bg-gray-50"
              >
                Customer Name
              </th>
              <td mat-cell *matCellDef="let element" class="px-4 py-3">
                {{ element.buyerOrgName }}
              </td>
            </ng-container>

            <ng-container matColumnDef="supplier">
              <th
                mat-header-cell
                *matHeaderCellDef
                mat-sort-header="supplier"
                class="px-4 py-3 text-xs font-medium text-gray-500 uppercase tracking-wider bg-gray-50"
              >
                Supplier
              </th>
              <td mat-cell *matCellDef="let element" class="px-4 py-3">
                {{ element.supplier }}
              </td>
            </ng-container>
            <ng-container matColumnDef="orderDate">
              <th mat-header-cell *matHeaderCellDef mat-sort-header="orderDate">
                Order Date
              </th>
              <td mat-cell *matCellDef="let element">
                <ng-container
                  *ngIf="
                    editingIndex === element._rowIndex && editingTab === 0;
                    else showOrderDate
                  "
                >
                  <input
                    #dateInput
                    type="date"
                    [ngModel]="editingItem.orderDate | date: 'yyyy-MM-dd'"
                    (click)="dateInput.showPicker()"
                    class="w-full px-2 py-1 border rounded"
                    name="orderDate"
                  />
                </ng-container>
                <ng-template #showOrderDate>
                  {{ element.orderDate | date }}
                </ng-template>
              </td>
            </ng-container>

            <ng-container matColumnDef="deliverySchedule">
              <th
                mat-header-cell
                *matHeaderCellDef
                mat-sort-header="deliverySchedule"
              >
                Delivery Schedule
              </th>
              <td mat-cell *matCellDef="let element">
                <ng-container
                  *ngIf="
                    editingIndex === element._rowIndex && editingTab === 0;
                    else showDeliverySchedule
                  "
                >
                  <input
                    #dateInput
                    type="date"
                    (click)="dateInput.showPicker()"
                    class="w-full px-2 py-1 border rounded"
                    [(ngModel)]="editingItem.deliverySchedule"
                    name="deliverySchedule"
                  />
                </ng-container>
                <ng-template #showDeliverySchedule>
                  {{ element.deliverySchedule | date }}
                </ng-template>
              </td>
            </ng-container>

            <ng-container matColumnDef="destination">
              <th
                mat-header-cell
                *matHeaderCellDef
                mat-sort-header="destination"
              >
                Destination
              </th>
              <td mat-cell *matCellDef="let element">
                <ng-container
                  *ngIf="
                    editingIndex === element._rowIndex && editingTab === 0;
                    else showDestination
                  "
                >
                  <input
                    class="w-full px-2 py-1 border rounded"
                    [(ngModel)]="editingItem.destination"
                  />
                </ng-container>
                <ng-template #showDestination>{{
                  element.destination
                }}</ng-template>
              </td>
            </ng-container>

            <ng-container matColumnDef="paymentTerms">
              <th
                mat-header-cell
                *matHeaderCellDef
                mat-sort-header="paymentTerms"
              >
                Payment Terms
              </th>
              <td mat-cell *matCellDef="let element">
                <ng-container
                  *ngIf="
                    editingIndex === element._rowIndex && editingTab === 0;
                    else showPaymentTerms
                  "
                >
                  <input
                    class="w-full px-2 py-1 border rounded"
                    [(ngModel)]="editingItem.paymentTerms"
                  />
                </ng-container>
                <ng-template #showPaymentTerms>{{
                  element.paymentTerms
                }}</ng-template>
              </td>
            </ng-container>

            <ng-container matColumnDef="deliveryTerms">
              <th
                mat-header-cell
                *matHeaderCellDef
                mat-sort-header="deliveryTerms"
              >
                Delivery Terms
              </th>
              <td mat-cell *matCellDef="let element">
                <ng-container
                  *ngIf="
                    editingIndex === element._rowIndex && editingTab === 0;
                    else showDeliveryTerms
                  "
                >
                  <input
                    class="w-full px-2 py-1 border rounded"
                    [(ngModel)]="editingItem.deliveryTerms"
                  />
                </ng-container>
                <ng-template #showDeliveryTerms>{{
                  element.deliveryTerms
                }}</ng-template>
              </td>
            </ng-container>

            <ng-container matColumnDef="modeOfShipment">
              <th
                mat-header-cell
                *matHeaderCellDef
                mat-sort-header="modeOfShipment"
              >
                Mode of Shipment
              </th>
              <td mat-cell *matCellDef="let element">
                <ng-container
                  *ngIf="
                    editingIndex === element._rowIndex && editingTab === 0;
                    else showModeOfShipment
                  "
                >
                  <input
                    class="w-full px-2 py-1 border rounded"
                    [(ngModel)]="editingItem.modeOfShipment"
                  />
                </ng-container>
                <ng-template #showModeOfShipment>{{
                  element.modeOfShipment
                }}</ng-template>
              </td>
            </ng-container>

            <ng-container matColumnDef="shippingCharges">
              <th
                mat-header-cell
                *matHeaderCellDef
                mat-sort-header="shippingCharges"
              >
                Shipping Charges
              </th>
              <td mat-cell *matCellDef="let element">
                <ng-container
                  *ngIf="
                    editingIndex === element._rowIndex && editingTab === 0;
                    else showShippingCharges
                  "
                >
                  <input
                    type="number"
                    class="w-full px-2 py-1 border rounded"
                    [(ngModel)]="editingItem.shippingCharges"
                  />
                </ng-container>
                <ng-template #showShippingCharges>{{
                  element.shippingCharges | currency
                }}</ng-template>
              </td>
            </ng-container>

            <ng-container matColumnDef="discount">
              <th mat-header-cell *matHeaderCellDef mat-sort-header="discount">
                Discount
              </th>
              <td mat-cell *matCellDef="let element">
                <ng-container
                  *ngIf="
                    editingIndex === element._rowIndex && editingTab === 0;
                    else showDisc
                  "
                >
                  <input
                    type="number"
                    class="w-full px-2 py-1 border rounded"
                    [(ngModel)]="editingItem.discount"
                  />
                </ng-container>
                <ng-template #showDisc>{{ element.discount }}</ng-template>
              </td>
            </ng-container>

            <ng-container matColumnDef="totalCost">
              <th mat-header-cell *matHeaderCellDef mat-sort-header="totalCost">
                Total Cost
              </th>
              <td mat-cell *matCellDef="let element">
                <ng-container
                  *ngIf="
                    editingIndex === element._rowIndex && editingTab === 0;
                    else showCost
                  "
                >
                  <input
                    type="number"
                    class="w-full px-2 py-1 border rounded"
                    [(ngModel)]="editingItem.totalCost"
                  />
                </ng-container>
                <ng-template #showCost>{{
                  element.totalCost | currency
                }}</ng-template>
              </td>
            </ng-container>
            <!-- totalAmount -->
            <ng-container matColumnDef="totalAmount">
              <th
                mat-header-cell
                *matHeaderCellDef
                mat-sort-header="totalAmount"
              >
                Total Amount
              </th>
              <td mat-cell *matCellDef="let element">
                <ng-container
                  *ngIf="
                    editingIndex === element._rowIndex && editingTab === 0;
                    else showAmt
                  "
                >
                  <input
                    type="number"
                    class="w-full px-2 py-1 border rounded"
                    [(ngModel)]="editingItem.totalAmount"
                  />
                </ng-container>
                <ng-template #showAmt>{{
                  element.totalAmount | currency
                }}</ng-template>
              </td>
            </ng-container>

            <ng-container matColumnDef="poStatus">
              <th
                mat-header-cell
                *matHeaderCellDef
                mat-sort-header="poStatus"
                class="px-4 py-3 text-xs font-medium text-gray-500 uppercase tracking-wider bg-gray-50"
              >
                Status
              </th>
              <td mat-cell *matCellDef="let element" class="px-4 py-3">
                <span
                  class="px-2.5 py-0.5 rounded-full text-xs font-medium capitalize"
                  [ngClass]="{
                    'bg-blue-100 text-blue-800': element.poStatus === 'Created',
                    'bg-green-100 text-green-800':
                      element.poStatus === 'Approved',
                    'bg-yellow-100 text-yellow-800':
                      element.poStatus === 'Processing',
                    'bg-indigo-100 text-indigo-800':
                      element.poStatus === 'Completed',
                    'bg-sky-100 text-sky-800': element.poStatus === 'Sent',
                    'bg-lime-100 text-lime-800':
                      element.poStatus === 'Supplier Confirmed',
                    'bg-purple-100 text-purple-800':
                      element.poStatus === 'Received',
                    'bg-teal-100 text-teal-800':
                      element.poStatus === 'Invoiced',
                    'bg-gray-100 text-gray-800': element.poStatus === 'Closed',
                  }"
                >
                  {{ element.poStatus }}
                </span>
              </td>
            </ng-container>

            <ng-container matColumnDef="actions">
              <th mat-header-cell *matHeaderCellDef>Actions</th>
              <td mat-cell *matCellDef="let element">
                <ng-container
                  *ngIf="
                    editingIndex === element._rowIndex && editingTab === 0;
                    else editBtn
                  "
                >
                  <div class="flex gap-1">
                    <button
                      (click)="$event.stopPropagation(); saveItem()"
                      class="mr-2 bg-green-600 text-white px-3 py-1 rounded disabled:bg-green-300 disabled:cursor-not-allowed"
                      [disabled]="isediting"
                    >
                      <ng-container *ngIf="!isediting">Save</ng-container>
                      <ng-container *ngIf="isediting">
                        <div class="flex">
                          <span>Saving </span>
                          <span class="loading-dots">
                            <span class="dot">.</span>
                            <span class="dot">.</span>
                            <span class="dot">.</span>
                          </span>
                        </div>
                      </ng-container>
                    </button>
                    <button
                      (click)="$event.stopPropagation(); cancelEdit()"
                      class="bg-gray-200 px-3 py-1 rounded"
                    >
                      Cancel
                    </button>
                  </div>
                </ng-container>
                <ng-template #editBtn>
                  <button
                    (click)="
                      $event.stopPropagation();
                      editItem(element._rowIndex, element)
                    "
                    type="button"
                    class="bg-green-500 text-white px-2 py-1 rounded"
                  >
                    Edit
                  </button>
                </ng-template>
              </td>
            </ng-container>

            <tr mat-header-row *matHeaderRowDef="activeDisplayedColumns"></tr>

            <tr
              mat-row
              *matRowDef="let element; columns: activeDisplayedColumns"
              (click)="editingIndex === null && openPOModel(element)"
              class="example-element-row cursor-pointer bg-white border-b hover:bg-gray-50"
            ></tr>
          </table>
        </div>

        <div class="mt-10" *ngIf="!isLoading && sortedData.data.length === 0">
          <p class="text-center py-8 text-gray-500 text-sm">
            No data to display
          </p>
        </div>
        <div class="mt-10" *ngIf="isLoading">
          <p class="text-center py-8 text-gray-500 text-sm">
            <span>Loading Data</span>
            <span class="loading-dots">
              <span class="dot">.</span>
              <span class="dot">.</span>
              <span class="dot">.</span>
            </span>
          </p>
        </div>
      </div>
    </mat-tab>

    <mat-tab label="OUTGOING">
      <div
        class="overflow-x-auto shadow-sm rounded-lg border border-gray-200 mt-4 bg-white"
      >
        <div *ngIf="!isLoading">
          <table
            mat-table
            class="w-full text-sm text-left text-gray-500"
            [dataSource]="sortedData"
            (matSortChange)="sortData($event)"
            matSort
            #empTbSort="matSort"
          >
            <ng-container matColumnDef="poNumber">
              <th
                mat-header-cell
                *matHeaderCellDef
                mat-sort-header="poNumber"
                class="px-4 py-3 text-xs font-medium text-gray-500 uppercase tracking-wider bg-gray-50"
              >
                #PO
              </th>
              <td
                mat-cell
                *matCellDef="let element"
                class="px-4 py-3 font-medium text-gray-900 whitespace-nowrap"
              >
                {{ element.poNumber }}
              </td>
            </ng-container>

            <ng-container matColumnDef="customerName">
              <th
                mat-header-cell
                *matHeaderCellDef
                mat-sort-header="customerName"
                class="px-4 py-3 text-xs font-medium text-gray-500 uppercase tracking-wider bg-gray-50"
              >
                Customer Name
              </th>
              <td mat-cell *matCellDef="let element" class="px-4 py-3">
                {{ element.buyerOrgName }}
              </td>
            </ng-container>

            <ng-container matColumnDef="supplier">
              <th
                mat-header-cell
                *matHeaderCellDef
                mat-sort-header="supplier"
                class="px-4 py-3 text-xs font-medium text-gray-500 uppercase tracking-wider bg-gray-50"
              >
                Supplier
              </th>
              <td mat-cell *matCellDef="let element" class="px-4 py-3">
                {{ element.supplier }}
              </td>
            </ng-container>
            <ng-container matColumnDef="destination">
              <th
                mat-header-cell
                *matHeaderCellDef
                mat-sort-header="destination"
              >
                Destination
              </th>
              <td mat-cell *matCellDef="let element">
                <ng-container
                  *ngIf="
                    editingIndex === element._rowIndex && editingTab === 1;
                    else showDestination
                  "
                >
                  <input
                    class="w-full px-2 py-1 border rounded"
                    [(ngModel)]="editingItem.destination"
                  />
                </ng-container>
                <ng-template #showDestination>{{
                  element.destination
                }}</ng-template>
              </td>
            </ng-container>

            <ng-container matColumnDef="orderDate">
              <th mat-header-cell *matHeaderCellDef mat-sort-header="orderDate">
                Order Date
              </th>
              <td mat-cell *matCellDef="let element">
                <ng-container
                  *ngIf="
                    editingIndex === element._rowIndex && editingTab === 1;
                    else showOrderDate
                  "
                >
                  <input
                    #dateInput
                    type="date"
                    [ngModel]="editingItem.orderDate | date: 'yyyy-MM-dd'"
                    (click)="dateInput.showPicker()"
                    class="w-full px-2 py-1 border rounded"
                    name="orderDate"
                  />
                </ng-container>
                <ng-template #showOrderDate>
                  {{ element.orderDate | date }}
                </ng-template>
              </td>
            </ng-container>

            <ng-container matColumnDef="deliverySchedule">
              <th
                mat-header-cell
                *matHeaderCellDef
                mat-sort-header="deliverySchedule"
              >
                Delivery Schedule
              </th>
              <td mat-cell *matCellDef="let element">
                <ng-container
                  *ngIf="
                    editingIndex === element._rowIndex && editingTab === 1;
                    else showDeliverySchedule
                  "
                >
                  <input
                    #dateInput
                    type="date"
                    (click)="dateInput.showPicker()"
                    class="w-full px-2 py-1 border rounded"
                    [(ngModel)]="editingItem.deliverySchedule"
                    name="deliverySchedule"
                  />
                </ng-container>
                <ng-template #showDeliverySchedule>
                  {{ element.deliverySchedule | date }}
                </ng-template>
              </td>
            </ng-container>

            <ng-container matColumnDef="paymentTerms">
              <th
                mat-header-cell
                *matHeaderCellDef
                mat-sort-header="paymentTerms"
              >
                Payment Terms
              </th>
              <td mat-cell *matCellDef="let element">
                <ng-container
                  *ngIf="
                    editingIndex === element._rowIndex && editingTab === 1;
                    else showPaymentTerms
                  "
                >
                  <input
                    class="w-full px-2 py-1 border rounded"
                    [(ngModel)]="editingItem.paymentTerms"
                  />
                </ng-container>
                <ng-template #showPaymentTerms>{{
                  element.paymentTerms
                }}</ng-template>
              </td>
            </ng-container>

            <ng-container matColumnDef="deliveryTerms">
              <th
                mat-header-cell
                *matHeaderCellDef
                mat-sort-header="deliveryTerms"
              >
                Delivery Terms
              </th>
              <td mat-cell *matCellDef="let element">
                <ng-container
                  *ngIf="
                    editingIndex === element._rowIndex && editingTab === 1;
                    else showDeliveryTerms
                  "
                >
                  <input
                    class="w-full px-2 py-1 border rounded"
                    [(ngModel)]="editingItem.deliveryTerms"
                  />
                </ng-container>
                <ng-template #showDeliveryTerms>{{
                  element.deliveryTerms
                }}</ng-template>
              </td>
            </ng-container>

            <ng-container matColumnDef="modeOfShipment">
              <th
                mat-header-cell
                *matHeaderCellDef
                mat-sort-header="modeOfShipment"
              >
                Mode of Shipment
              </th>
              <td mat-cell *matCellDef="let element">
                <ng-container
                  *ngIf="
                    editingIndex === element._rowIndex && editingTab === 1;
                    else showModeOfShipment
                  "
                >
                  <input
                    class="w-full px-2 py-1 border rounded"
                    [(ngModel)]="editingItem.modeOfShipment"
                  />
                </ng-container>
                <ng-template #showModeOfShipment>{{
                  element.modeOfShipment
                }}</ng-template>
              </td>
            </ng-container>

            <ng-container matColumnDef="shippingCharges">
              <th
                mat-header-cell
                *matHeaderCellDef
                mat-sort-header="shippingCharges"
              >
                Shipping Charges
              </th>
              <td mat-cell *matCellDef="let element">
                <ng-container
                  *ngIf="
                    editingIndex === element._rowIndex && editingTab === 1;
                    else showShippingCharges
                  "
                >
                  <input
                    type="number"
                    class="w-full px-2 py-1 border rounded"
                    [(ngModel)]="editingItem.shippingCharges"
                  />
                </ng-container>
                <ng-template #showShippingCharges>{{
                  element.shippingCharges | currency
                }}</ng-template>
              </td>
            </ng-container>

            <ng-container matColumnDef="discount">
              <th mat-header-cell *matHeaderCellDef mat-sort-header="discount">
                Discount
              </th>
              <td mat-cell *matCellDef="let element">
                <ng-container
                  *ngIf="
                    editingIndex === element._rowIndex && editingTab === 1;
                    else showDisc
                  "
                >
                  <input
                    type="number"
                    class="w-full px-2 py-1 border rounded"
                    [(ngModel)]="editingItem.discount"
                  />
                </ng-container>
                <ng-template #showDisc>{{ element.discount }}</ng-template>
              </td>
            </ng-container>

            <ng-container matColumnDef="totalCost">
              <th mat-header-cell *matHeaderCellDef mat-sort-header="totalCost">
                Total Cost
              </th>
              <td mat-cell *matCellDef="let element">
                <ng-container
                  *ngIf="
                    editingIndex === element._rowIndex && editingTab === 0;
                    else showCost
                  "
                >
                  <input
                    type="number"
                    class="w-full px-2 py-1 border rounded"
                    [(ngModel)]="editingItem.totalCost"
                  />
                </ng-container>
                <ng-template #showCost>{{
                  element.totalCost | currency
                }}</ng-template>
              </td>
            </ng-container>
            <!-- totalAmount -->
            <ng-container matColumnDef="totalAmount">
              <th
                mat-header-cell
                *matHeaderCellDef
                mat-sort-header="totalAmount"
              >
                Total Amount
              </th>
              <td mat-cell *matCellDef="let element">
                <ng-container
                  *ngIf="
                    editingIndex === element._rowIndex && editingTab === 1;
                    else showAmt
                  "
                >
                  <input
                    type="number"
                    class="w-full px-2 py-1 border rounded"
                    [(ngModel)]="editingItem.totalAmount"
                  />
                </ng-container>
                <ng-template #showAmt>{{
                  element.totalAmount | currency
                }}</ng-template>
              </td>
            </ng-container>

            <ng-container matColumnDef="poStatus">
              <th
                mat-header-cell
                *matHeaderCellDef
                mat-sort-header="poStatus"
                class="px-4 py-3 text-xs font-medium text-gray-500 uppercase tracking-wider bg-gray-50"
              >
                Status
              </th>
              <td mat-cell *matCellDef="let element" class="px-4 py-3">
                <span
                  class="px-2.5 py-0.5 rounded-full text-xs font-medium capitalize"
                  [ngClass]="{
                    'bg-blue-100 text-blue-800': element.poStatus === 'Created',
                    'bg-green-100 text-green-800':
                      element.poStatus === 'Approved',
                    'bg-yellow-100 text-yellow-800':
                      element.poStatus === 'Processing',
                    'bg-indigo-100 text-indigo-800':
                      element.poStatus === 'Completed',
                    'bg-sky-100 text-sky-800': element.poStatus === 'Sent',
                    'bg-lime-100 text-lime-800':
                      element.poStatus === 'Supplier Confirmed',
                    'bg-purple-100 text-purple-800':
                      element.poStatus === 'Received',
                    'bg-teal-100 text-teal-800':
                      element.poStatus === 'Invoiced',
                    'bg-gray-100 text-gray-800': element.poStatus === 'Closed',
                  }"
                >
                  {{ element.poStatus }}
                </span>
              </td>
            </ng-container>

            <ng-container matColumnDef="actions">
              <th mat-header-cell *matHeaderCellDef>Actions</th>
              <td mat-cell *matCellDef="let element">
                <ng-container
                  *ngIf="
                    editingIndex === element._rowIndex && editingTab === 1;
                    else editBtn
                  "
                >
                  <div class="flex gap-1">
                    <button
                      (click)="$event.stopPropagation(); saveItem()"
                      class="mr-2 bg-green-600 text-white px-3 py-1 rounded disabled:bg-green-300 disabled:cursor-not-allowed"
                      [disabled]="isediting"
                    >
                      <ng-container *ngIf="!isediting">Save</ng-container>
                      <ng-container *ngIf="isediting">
                        <div class="flex">
                          <span>Saving </span>
                          <span class="loading-dots">
                            <span class="dot">.</span>
                            <span class="dot">.</span>
                            <span class="dot">.</span>
                          </span>
                        </div>
                      </ng-container>
                    </button>
                    <button
                      (click)="$event.stopPropagation(); cancelEdit()"
                      class="bg-gray-200 px-3 py-1 rounded"
                    >
                      Cancel
                    </button>
                  </div>
                </ng-container>
                <ng-template #editBtn>
                  <button
                    (click)="
                      $event.stopPropagation();
                      editItem(element._rowIndex, element)
                    "
                    type="button"
                    class="bg-green-500 text-white px-2 py-1 rounded"
                  >
                    Edit
                  </button>
                </ng-template>
              </td>
            </ng-container>

            <tr mat-header-row *matHeaderRowDef="activeDisplayedColumns"></tr>

            <tr
              mat-row
              *matRowDef="let element; columns: activeDisplayedColumns"
              (click)="editingIndex === null && openPOModel(element)"
              class="example-element-row cursor-pointer bg-white border-b hover:bg-gray-50"
            ></tr>
          </table>
        </div>

        <div class="mt-10" *ngIf="!isLoading && sortedData.data.length === 0">
          <p class="text-center py-8 text-gray-500 text-sm">
            No data to display
          </p>
        </div>
        <div class="mt-10" *ngIf="isLoading">
          <p class="text-center py-8 text-gray-500 text-sm">
            <span>Loading Data</span>
            <span class="loading-dots">
              <span class="dot">.</span>
              <span class="dot">.</span>
              <span class="dot">.</span>
            </span>
          </p>
        </div>
      </div>
    </mat-tab>
    <mat-tab label="DUMMY">
      <div
        class="overflow-x-auto shadow-sm rounded-lg border border-gray-200 mt-4 bg-white"
      >
        <div *ngIf="!isLoading">
          <table
            mat-table
            class="w-full text-sm text-left text-gray-500"
            [dataSource]="sortedData"
            (matSortChange)="sortData($event)"
            matSort
            #empTbSort="matSort"
          >
            <ng-container matColumnDef="poNumber">
              <th
                mat-header-cell
                *matHeaderCellDef
                mat-sort-header="poNumber"
                class="px-4 py-3 text-xs font-medium text-gray-500 uppercase tracking-wider bg-gray-50"
              >
                #PO
              </th>
              <td
                mat-cell
                *matCellDef="let element"
                class="px-4 py-3 font-medium text-gray-900 whitespace-nowrap"
              >
                {{ element.poNumber }}
              </td>
            </ng-container>

            <ng-container matColumnDef="customerName">
              <th
                mat-header-cell
                *matHeaderCellDef
                mat-sort-header="customerName"
                class="px-4 py-3 text-xs font-medium text-gray-500 uppercase tracking-wider bg-gray-50"
              >
                Customer Name
              </th>
              <td mat-cell *matCellDef="let element" class="px-4 py-3">
                {{ element.buyerOrgName }}
              </td>
            </ng-container>

            <ng-container matColumnDef="supplier">
              <th
                mat-header-cell
                *matHeaderCellDef
                mat-sort-header="supplier"
                class="px-4 py-3 text-xs font-medium text-gray-500 uppercase tracking-wider bg-gray-50"
              >
                Supplier
              </th>
              <td mat-cell *matCellDef="let element" class="px-4 py-3">
                {{ element.supplier }}
              </td>
            </ng-container>
            <ng-container matColumnDef="destination">
              <th
                mat-header-cell
                *matHeaderCellDef
                mat-sort-header="destination"
              >
                Destination
              </th>
              <td mat-cell *matCellDef="let element">
                <ng-container
                  *ngIf="
                    editingIndex === element._rowIndex && editingTab === 2;
                    else showDestination
                  "
                >
                  <input
                    class="w-full px-2 py-1 border rounded"
                    [(ngModel)]="editingItem.destination"
                  />
                </ng-container>
                <ng-template #showDestination>{{
                  element.destination
                }}</ng-template>
              </td>
            </ng-container>

            <ng-container matColumnDef="orderDate">
              <th mat-header-cell *matHeaderCellDef mat-sort-header="orderDate">
                Order Date
              </th>
              <td mat-cell *matCellDef="let element">
                <ng-container
                  *ngIf="
                    editingIndex === element._rowIndex && editingTab === 2;
                    else showOrderDate
                  "
                >
                  <input
                    #dateInput
                    type="date"
                    [ngModel]="editingItem.orderDate | date: 'yyyy-MM-dd'"
                    (click)="dateInput.showPicker()"
                    class="w-full px-2 py-1 border rounded"
                    name="orderDate"
                  />
                </ng-container>
                <ng-template #showOrderDate>
                  {{ element.orderDate | date }}
                </ng-template>
              </td>
            </ng-container>

            <ng-container matColumnDef="deliverySchedule">
              <th
                mat-header-cell
                *matHeaderCellDef
                mat-sort-header="deliverySchedule"
              >
                Delivery Schedule
              </th>
              <td mat-cell *matCellDef="let element">
                <ng-container
                  *ngIf="
                    editingIndex === element._rowIndex && editingTab === 2;
                    else showDeliverySchedule
                  "
                >
                  <input
                    #dateInput
                    type="date"
                    (click)="dateInput.showPicker()"
                    class="w-full px-2 py-1 border rounded"
                    [(ngModel)]="editingItem.deliverySchedule"
                    name="deliverySchedule"
                  />
                </ng-container>
                <ng-template #showDeliverySchedule>
                  {{ element.deliverySchedule | date }}
                </ng-template>
              </td>
            </ng-container>

            <ng-container matColumnDef="paymentTerms">
              <th
                mat-header-cell
                *matHeaderCellDef
                mat-sort-header="paymentTerms"
              >
                Payment Terms
              </th>
              <td mat-cell *matCellDef="let element">
                <ng-container
                  *ngIf="
                    editingIndex === element._rowIndex && editingTab === 2;
                    else showPaymentTerms
                  "
                >
                  <input
                    class="w-full px-2 py-1 border rounded"
                    [(ngModel)]="editingItem.paymentTerms"
                  />
                </ng-container>
                <ng-template #showPaymentTerms>{{
                  element.paymentTerms
                }}</ng-template>
              </td>
            </ng-container>

            <ng-container matColumnDef="deliveryTerms">
              <th
                mat-header-cell
                *matHeaderCellDef
                mat-sort-header="deliveryTerms"
              >
                Delivery Terms
              </th>
              <td mat-cell *matCellDef="let element">
                <ng-container
                  *ngIf="
                    editingIndex === element._rowIndex && editingTab === 2;
                    else showDeliveryTerms
                  "
                >
                  <input
                    class="w-full px-2 py-1 border rounded"
                    [(ngModel)]="editingItem.deliveryTerms"
                  />
                </ng-container>
                <ng-template #showDeliveryTerms>{{
                  element.deliveryTerms
                }}</ng-template>
              </td>
            </ng-container>

            <ng-container matColumnDef="modeOfShipment">
              <th
                mat-header-cell
                *matHeaderCellDef
                mat-sort-header="modeOfShipment"
              >
                Mode of Shipment
              </th>
              <td mat-cell *matCellDef="let element">
                <ng-container
                  *ngIf="
                    editingIndex === element._rowIndex && editingTab === 2;
                    else showModeOfShipment
                  "
                >
                  <input
                    class="w-full px-2 py-1 border rounded"
                    [(ngModel)]="editingItem.modeOfShipment"
                  />
                </ng-container>
                <ng-template #showModeOfShipment>{{
                  element.modeOfShipment
                }}</ng-template>
              </td>
            </ng-container>

            <ng-container matColumnDef="shippingCharges">
              <th
                mat-header-cell
                *matHeaderCellDef
                mat-sort-header="shippingCharges"
              >
                Shipping Charges
              </th>
              <td mat-cell *matCellDef="let element">
                <ng-container
                  *ngIf="
                    editingIndex === element._rowIndex && editingTab === 2;
                    else showShippingCharges
                  "
                >
                  <input
                    type="number"
                    class="w-full px-2 py-1 border rounded"
                    [(ngModel)]="editingItem.shippingCharges"
                  />
                </ng-container>
                <ng-template #showShippingCharges>{{
                  element.shippingCharges | currency
                }}</ng-template>
              </td>
            </ng-container>

            <ng-container matColumnDef="discount">
              <th mat-header-cell *matHeaderCellDef mat-sort-header="discount">
                Discount
              </th>
              <td mat-cell *matCellDef="let element">
                <ng-container
                  *ngIf="
                    editingIndex === element._rowIndex && editingTab === 2;
                    else showDisc
                  "
                >
                  <input
                    type="number"
                    class="w-full px-2 py-1 border rounded"
                    [(ngModel)]="editingItem.discount"
                  />
                </ng-container>
                <ng-template #showDisc>{{ element.discount }}</ng-template>
              </td>
            </ng-container>

            <ng-container matColumnDef="totalCost">
              <th mat-header-cell *matHeaderCellDef mat-sort-header="totalCost">
                Total Cost
              </th>
              <td mat-cell *matCellDef="let element">
                <ng-container
                  *ngIf="
                    editingIndex === element._rowIndex && editingTab === 2;
                    else showCost
                  "
                >
                  <input
                    type="number"
                    class="w-full px-2 py-1 border rounded"
                    [(ngModel)]="editingItem.totalCost"
                  />
                </ng-container>
                <ng-template #showCost>{{
                  element.totalCost | currency
                }}</ng-template>
              </td>
            </ng-container>
            <!-- totalAmount -->
            <ng-container matColumnDef="totalAmount">
              <th
                mat-header-cell
                *matHeaderCellDef
                mat-sort-header="totalAmount"
              >
                Total Amount
              </th>
              <td mat-cell *matCellDef="let element">
                <ng-container
                  *ngIf="
                    editingIndex === element._rowIndex && editingTab === 2;
                    else showAmt
                  "
                >
                  <input
                    type="number"
                    class="w-full px-2 py-1 border rounded"
                    [(ngModel)]="editingItem.totalAmount"
                  />
                </ng-container>
                <ng-template #showAmt>{{
                  element.totalAmount | currency
                }}</ng-template>
              </td>
            </ng-container>

            <ng-container matColumnDef="poStatus">
              <th
                mat-header-cell
                *matHeaderCellDef
                mat-sort-header="poStatus"
                class="px-4 py-3 text-xs font-medium text-gray-500 uppercase tracking-wider bg-gray-50"
              >
                Status
              </th>
              <td mat-cell *matCellDef="let element" class="px-4 py-3">
                <span
                  class="px-2.5 py-0.5 rounded-full text-xs font-medium capitalize"
                  [ngClass]="{
                    'bg-blue-100 text-blue-800': element.poStatus === 'Created',
                    'bg-green-100 text-green-800':
                      element.poStatus === 'Approved',
                    'bg-yellow-100 text-yellow-800':
                      element.poStatus === 'Processing',
                    'bg-indigo-100 text-indigo-800':
                      element.poStatus === 'Completed',
                    'bg-sky-100 text-sky-800': element.poStatus === 'Sent',
                    'bg-lime-100 text-lime-800':
                      element.poStatus === 'Supplier Confirmed',
                    'bg-purple-100 text-purple-800':
                      element.poStatus === 'Received',
                    'bg-teal-100 text-teal-800':
                      element.poStatus === 'Invoiced',
                    'bg-gray-100 text-gray-800': element.poStatus === 'Closed',
                  }"
                >
                  {{ element.poStatus }}
                </span>
              </td>
            </ng-container>

            <ng-container matColumnDef="actions">
              <th mat-header-cell *matHeaderCellDef>Actions</th>
              <td mat-cell *matCellDef="let element">
                <ng-container
                  *ngIf="
                    editingIndex === element._rowIndex && editingTab === 2;
                    else editBtn
                  "
                >
                  <div class="flex gap-1">
                    <button
                      (click)="$event.stopPropagation(); saveItem()"
                      class="mr-2 bg-green-600 text-white px-3 py-1 rounded disabled:bg-green-300 disabled:cursor-not-allowed"
                      [disabled]="isediting"
                    >
                      <ng-container *ngIf="!isediting">Save</ng-container>
                      <ng-container *ngIf="isediting">
                        <div class="flex">
                          <span>Saving </span>
                          <span class="loading-dots">
                            <span class="dot">.</span>
                            <span class="dot">.</span>
                            <span class="dot">.</span>
                          </span>
                        </div>
                      </ng-container>
                    </button>
                    <button
                      (click)="$event.stopPropagation(); cancelEdit()"
                      class="bg-gray-200 px-3 py-1 rounded"
                    >
                      Cancel
                    </button>
                  </div>
                </ng-container>
                <ng-template #editBtn>
                  <button
                    (click)="
                      $event.stopPropagation();
                      editItem(element._rowIndex, element)
                    "
                    type="button"
                    class="bg-green-500 text-white px-2 py-1 rounded"
                  >
                    Edit
                  </button>
                </ng-template>
              </td>
            </ng-container>

            <tr mat-header-row *matHeaderRowDef="activeDisplayedColumns"></tr>

            <tr
              mat-row
              *matRowDef="let element; columns: activeDisplayedColumns"
              (click)="editingIndex === null && openPOModel(element)"
              class="example-element-row cursor-pointer bg-white border-b hover:bg-gray-50"
            ></tr>
          </table>
        </div>

        <div class="mt-10" *ngIf="!isLoading && sortedData.data.length === 0">
          <p class="text-center py-8 text-gray-500 text-sm">
            No data to display
          </p>
        </div>
        <div class="mt-10" *ngIf="isLoading">
          <p class="text-center py-8 text-gray-500 text-sm">
            <span>Loading Data</span>
            <span class="loading-dots">
              <span class="dot">.</span>
              <span class="dot">.</span>
              <span class="dot">.</span>
            </span>
          </p>
        </div>
      </div>
    </mat-tab>
  </mat-tab-group>
</section>
<mat-paginator
  class=""
  #paginator
  [length]="sortedData.data.length"
  [pageSize]="10"
  [pageSizeOptions]="[10, 50, 80, 100]"
></mat-paginator>
<app-po-model
  *ngIf="showModel"
  [po]="po"
  (onClick)="closePoModel($event)"
></app-po-model>
<app-add-po
  *ngIf="showAddPo"
  [customers]="customers"
  (onClick)="closeAddPo()"
></app-add-po>
